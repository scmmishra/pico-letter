<%= render 'newsletters/settings/partials/header' %>

<%= form_with model: @newsletter, url: update_sending_settings_path(slug: @newsletter.slug), method: :patch do |form| %>
  <div class="max-w-lg space-y-4">

    <label class="flex items-center gap-1">
      <%= form.check_box :use_custom_domain %>
      <%= form.label :use_custom_domain, "Use Custom Domain", class: "ml-px text-stone-500 text-sm"  %>
    </label>

    <label class="block space-y-1">
      <%= form.label :domain, "Domain Address", class: "ml-px text-stone-500 text-sm"  %>
      <%= form.text_field :domain, rows: 5, class: "input w-full block" %>
      <div class="font-sans text-xs text-stone-400">Do not add https:// or http:// just the domain name, like "example.com"</div>
    </label>

    <label class="block space-y-1">
      <%= form.label :sending_address, "Sending Address", class: "ml-px text-stone-500 text-sm"  %>
      <%= form.text_field :sending_address, rows: 5, class: "input w-full block" %>
    </label>

    <label class="block space-y-1">
      <%= form.label :reply_to, "Reply To", class: "ml-px text-stone-500 text-sm"  %>
      <%= form.text_field :reply_to, rows: 5, class: "input w-full block" %>
    </label>
  </div>
  <div class="mt-5">
    <%= form.submit 'Update Settings', class: 'btn btn-primary' %>
  </div>
<% end %>

<% if @newsletter.use_custom_domain %>
  <% if @newsletter.domain_verified %>
    <div class="max-w-lg mt-8">
      <h3 class="text-lg font-medium text-stone-800">âœ… Domain is Verified</h3>
      <p class="mt-1 text-stone-600">Your domain has been verified successfully. You can now send emails using your custom domain. The following are the DNS records you have added.</p>
    </div>
    <%= render 'newsletters/settings/partials/dns_records', newsletter: @newsletter %>
  <% else %>
    <%= form_with model: @newsletter, url: verify_domain_settings_path(slug: @newsletter.slug), method: :post, class: "mt-8" do |form| %>
      <div class="max-w-lg">
        <h3 class="text-lg font-medium text-stone-800">Domain Verificaiton Pending</h3>
        <p class="mt-1 text-stone-600">Add the following DNS records to your DNS settings, to verify your domain. Verification ensures your emails are delivered properly and does not end up in spam.</p>
      </div>

      <%= render 'newsletters/settings/partials/dns_records', newsletter: @newsletter %>
      <p class="mt-1 ml-1 font-sans text-xs text-stone-400">In case you're facing any trouble, you can drop us an email, and we will help you set it up.</p>
      <div class="mt-4">
        <%= form.submit 'Verify DNS Records', class: 'btn btn-secondary' %>
      </div>
    <% end %>
  <% end %>
<% end %>