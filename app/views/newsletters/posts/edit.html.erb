<%= form_with model: @post, url: post_path(slug: @newsletter.slug, id: @post.id), method: :patch do |form| %>
  <%= form.hidden_field :newsletter_id, value: @newsletter.id %>
  <div class="max-w-2xl mx-auto">
    <label class="space-y-1">
      <%= form.label :title, "Subject", class: "ml-px text-stone-500"  %>
      <%= form.text_field :title, required: true, class: "input w-full", autofocus: true %>
    </label>
  </div>
  <div class="max-w-2xl mx-auto mt-5 prose prose-h1:text-2xl">
    <%= form.rich_text_area :content %>
  </div>
  <div class="flex items-end justify-between max-w-2xl gap-2 mx-auto mt-2">
    <div>
      <%= form.submit 'Save Draft', class: 'btn btn-primary' %>
    </div>
    <div>
      <%= link_to 'Publish & Send', publish_post_path(slug: @newsletter.slug, id: @post.id), class: 'btn btn-success', data: { turbo_method: :post, turbo_confirm: 'Are you sure you want to publish and send this post now?' } %>
    </div>
  </div>
<% end %>

<div class="max-w-2xl mx-auto mt-8 space-y-5">
  <%= form_with model: @post, url: schedule_post_path(slug: @newsletter.slug, id: @post.id), class: 'p-5 -mx-5 border rounded-xl border-stone-100 bg-stone-50', method: :post do |form| %>
    <h3 class="font-sans text-xs font-bold tracking-widest uppercase text-stone-800">Schedule post</h3>
    <p class="mt-1 text-stone-800/70">Schedule it to automatically send it later. You can disable this later.</p>
    <%= form.label :scheduled_at, "Send at", class: "block text-sm font-medium text-stone-700 sr-only" %>
    <%= form.datetime_field :scheduled_at, class: "mt-1 input w-full font-sans" %>
    <%= form.submit 'Schedule for later', class: 'btn btn-secondary mt-4' %>
  <% end %>
  <div class="p-5 -mx-5 border rounded-xl border-red-100/50 bg-red-50">
    <h3 class="font-sans text-xs font-bold tracking-widest text-red-800 uppercase">Delete post</h3>
    <p class="mt-1 text-red-800/70">This is an unpublished post, deleting this means you will forever loose this.</p>
    <%= link_to 'Delete post forever', post_path(slug: @newsletter.slug, id: @post.id), class: 'btn btn-danger mt-4', data: { turbo_method: :delete, turbo_confirm: 'Are you sure you want to delete this post?' } %>
  </div>
</div>
