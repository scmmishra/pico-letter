<div class="flex items-center justify-between gap-2">
  <h2 class="text-xl font-medium">
    <%= link_to subscribers_path(@newsletter.slug), class:"text-stone-500 hover:text-stone-600" do %>
      Subscribers /
    <% end %>
    <%= @subscriber.display_name %>
    <div class="ml-3 inline">
      <% if @subscriber.verified? %>
        <span
          class="
            inline-flex items-center justify-center h-6 text-[10px] gap-x-1 font-medium px-2
            border-b border-green-200 uppercase tracking-widest font-sans text-green-500
            bg-green-100 rounded-md
          "
        >
          <%= lucide_icon("mail-check", class: "size-3") %>
          Verified
        </span>
      <% elsif @subscriber.unsubscribed? %>
        <span
          class="
            inline-flex items-center justify-center h-6 text-[10px] gap-x-1 font-medium
            border-orange-400 border px-2 uppercase tracking-widest font-sans
            text-orange-500 bg-orange-100 rounded-md
          "
        >
          <%= lucide_icon("mail-x", class: "size-3") %>
          Unsubscribed
        </span>
      <% elsif @subscriber.unverified? %>
        <span
          class="
            inline-flex items-center justify-center h-6 text-[10px] gap-x-1 font-medium
            border-yellow-400 border px-2 uppercase tracking-widest font-sans
            text-yellow-600 bg-yellow-100 rounded-md
          "
        >
          <%= lucide_icon("mail-question", class: "size-3") %>
          Verification Pending
        </span>
      <% end %>
    </div>
  </h2>
</div>

<%= form_with model: @subscriber, url: subscriber_path(@newsletter.slug, @subscriber.id), method: :patch, class: "max-w-lg space-y-4" do |form| %>
  <label class="block space-y-1">
    <%= form.label :email, class: "ml-px text-stone-500 text-sm" %>
    <%= form.text_field :email,
                    required: true,
                    disabled: true,
                    class: "input w-full bg-stone-200 text-stone-600" %>
  </label>
  <label class="block space-y-1">
    <%= form.label :full_name, "Full name", class: "ml-px text-stone-500 text-sm" %>
    <%= form.text_field :full_name,
                    required: true,
                    class: "input w-full",
                    autofocus: true %>
  </label>
  <label class="block space-y-1">
    <%= form.label :notes, "Editor notes", class: "ml-px text-stone-500 text-sm" %>
    <%= form.text_area :notes, rows: 5, class: "input w-full" %>
  </label>
  <%= form.submit "Update Subscriber", class: "btn btn-primary" %>
<% end %>

<hr class="max-w-lg my-8">
<section class="max-w-lg grid gap-6">
  <%= render "newsletters/subscribers/partials/action_card", title: "Delete Forever", help_text: "Delete the subscriber permanently, this cannot be undone" do %>
    <%= link_to subscribers_path(@newsletter.slug), class:"btn w-full btn-danger text-sm" do %>
      Delete Forever
    <% end %>
  <% end %>
  <% if @subscriber.unverified? %>
    <%= render "newsletters/subscribers/partials/action_card", title: "Resend Confirmation", help_text: "Send a reminder to #{@subscriber.display_name}, asking to cofirm their address." do %>
      <%= link_to subscribers_path(@newsletter.slug), class:"btn w-full btn-primary text-sm" do %>
        Send Reminder
      <% end %>
    <% end %>
  <% elsif @subscriber.verified? %>
    <%= render "newsletters/subscribers/partials/action_card", title: "Unsubscribe", help_text: "They won't receive any of your emails. You can resubscribe them without the need to reconfirm." do %>
      <%= link_to subscribers_path(@newsletter.slug), class:"btn w-full btn-warning text-sm" do %>
        Unsubscribe
      <% end %>
    <% end %>
  <% end %>
</section>
<hr class="max-w-lg my-8">
<section>
  <div class="leading-6 text-stone-800 font-medium text-sm font-sans">
    <% if @subscriber.unsubscribed? %>
      <span class="font-normal text-stone-500">Unsubscribed at</span>
      <%= @subscriber.unsubscribed_at.strftime("%B %d, %Y") %>
    <% elsif @subscriber.verified? %>
      <span class="font-normal text-stone-500">Verified at</span>
      <%= @subscriber.verified_at.strftime("%B %d, %Y") %>
    <% elsif @subscriber.unverified? %>
      <span class="font-normal text-stone-500">Subscribed at</span>
      <%= @subscriber.created_at.strftime("%B %d, %Y") %>
    <% end %>
  </div>
  <div class="leading-6 text-stone-800 font-medium text-sm font-sans">
    <span class="font-normal text-stone-500">Created at</span>
    <%= @subscriber.created_at.strftime("%B %d, %Y") %>
  </div>
</section>
